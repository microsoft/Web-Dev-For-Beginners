# å»ºç«‹å¤ªç©ºéŠæˆ² Part 5ï¼šåˆ†æ•¸èˆ‡ç”Ÿå‘½æ•¸

## èª²å‰æ¸¬é©—

[èª²å‰æ¸¬é©—](https://ashy-river-0debb7803.1.azurestaticapps.net/quiz/37?loc=zh_tw)

åœ¨é€™å ‚èª²ä¸­ï¼Œä½ æœƒå­¸ç¿’å¦‚ä½•ç‚ºéŠæˆ²åŠ å…¥è¨ˆåˆ†åŠŸèƒ½èˆ‡è¨ˆç®—æ€§å‘½æ•¸ã€‚

## åœ¨ç•«é¢ä¸Šç¹ªè£½æ–‡å­—

ç‚ºäº†åœ¨ç•«é¢ä¸Šé¡¯ç¤ºéŠæˆ²åˆ†æ•¸ï¼Œä½ éœ€è¦äº†è§£å¦‚ä½•é…ç½®æ–‡å­—ã€‚ç­”æ¡ˆæ˜¯åœ¨ Canvas ç‰©ä»¶ä¸Šä½¿ç”¨æ–¹æ³• `fillText()`ã€‚ä½ ä¹Ÿå¯ä»¥æ§åˆ¶å…¶ä»–ç‰¹å¾µï¼Œä¾‹å¦‚æ–‡å­—å­—å‹ã€æ–‡å­—é¡è‰²ç”šè‡³æ–‡å­—å°é½Šæ–¹å‘(å·¦ã€å³ã€ç½®ä¸­)ã€‚ä¸‹é¢æ˜¯åœ¨ç•«é¢ä¸­ç¹ªè£½ä¸€äº›æ–‡å­—ã€‚

```javascript
ctx.font = "30px Arial";
ctx.fillStyle = "red";
ctx.textAlign = "right";
ctx.fillText("show this on the screen", 0, 0);
```

âœ… é–±è®€æ›´å¤šé—œæ–¼[åœ¨ç•«å¸ƒä¸Šå»ºç«‹æ–‡å­—](https://developer.mozilla.org/docs/Web/API/Canvas_API/Tutorial/Drawing_text)ï¼Œä½ å¯ä»¥è‡ªç”±åœ°è±å¯Œä½ çš„æ–‡å­—ï¼

## æ€§å‘½ï¼Œä¸€å€‹éŠæˆ²æ¦‚å¿µ

éŠæˆ²ä¸­çš„ç”Ÿå‘½æ¦‚å¿µåªæ˜¯ä¸€å€‹æ•¸å­—ã€‚åœ¨å¤ªç©ºéŠæˆ²ä¸­ï¼Œåœ¨ä½ çš„èˆ¹è‰¦å—åˆ°æ”»æ“Šæ™‚ï¼Œæ‰£é™¤ç”Ÿå‘½å€¼æ˜¯ä¸€ç¨®å¸¸è¦‹çš„æ–¹å¼ã€‚å¦‚æœèƒ½ä»¥åœ–åƒçš„æ–¹å¼é¡¯ç¤ºç”Ÿå‘½å€¼ä¹Ÿæ˜¯å¾ˆå¥½çš„æ–¹å¼ï¼Œä¾‹å¦‚èˆ¹è‰¦åœ–ç¤ºã€å¿ƒè‡Ÿåœ–åƒï¼Œè€Œéå–®ç´”ä½¿ç”¨æ•¸å­—ã€‚

## å»ºç«‹ç›®æ¨™

æˆ‘å€‘åœ¨éŠæˆ²ä¸­æ–°å¢ä¸‹åˆ—åŠŸèƒ½ï¼š

- **éŠæˆ²åˆ†æ•¸**ï¼šç•¶æ¯ä¸€è‰˜æ•µè»è‰¦è‰‡è¢«æ‘§æ¯€æ™‚ï¼Œè‹±é›„æ‡‰è©²å–å¾—ä¸€äº›çå‹µåˆ†æ•¸ï¼Œæˆ‘å€‘å»ºè­°ä¸€è‰˜æ•µè‰¦ä¸€ç™¾åˆ†ã€‚éŠæˆ²ç¸½åˆ†æ‡‰è©²é¡¯ç¤ºåœ¨ç•«é¢çš„å·¦ä¸‹è§’ã€‚
- **ç”Ÿå‘½å€¼**ï¼šä½ çš„èˆ¹è‰¦æœ‰ä¸‰æ¢æ€§å‘½ã€‚åœ¨æ¯ä¸€æ¬¡æ•µè»è‰¦è‰‡æ’æ“Šä½ æ™‚ï¼Œä½ æœƒæå¤±ä¸€æ¢æ€§å‘½ã€‚ç”Ÿå‘½æ•¸æ‡‰è©²é¡¯ç¤ºåœ¨ç•«é¢çš„å³ä¸‹è§’ï¼Œä»¥ä¸‹åˆ—åœ–åƒé¡¯ç¤ºå‡ºä¾†ã€‚ ![æ€§å‘½åœ–ç‰‡](../solution/assets/life.png)

## å»ºè­°æ­¥é©Ÿ

åœ¨ä½ çš„ `your-work` å­è³‡æ–™å¤¾ä¸­ï¼Œç¢ºèªæª”æ¡ˆæ˜¯å¦å»ºç«‹å®Œæˆã€‚å®ƒæ‡‰è©²åŒ…æ‹¬ï¼š

```bash
-| assets
  -| enemyShip.png
  -| player.png
  -| laserRed.png
-| index.html
-| app.js
-| package.json
```

é–‹å§‹ `your_work` è³‡æ–™å¤¾ä¸­çš„å°ˆæ¡ˆï¼Œè¼¸å…¥ï¼š

```bash
cd your-work
npm start
```

é€™æœƒå•Ÿå‹• HTTP ä¼ºæœå™¨ä¸¦ç™¼å¸ƒç¶²å€ `http://localhost:5000`ã€‚é–‹å•Ÿç€è¦½å™¨ä¸¦è¼¸å…¥è©²ç¶²å€ï¼Œç¾åœ¨å®ƒèƒ½é¡¯ç¤ºå‡ºè‹±é›„èˆ‡æ‰€æœ‰çš„æ•µäººï¼Œåœ¨ä½ æ“ä½œæ–¹å‘éµå¾Œï¼Œè‹±é›„èƒ½ç§»å‹•ä¸¦æ“Šè½æ•µäººã€‚

### åŠ å…¥ç¨‹å¼ç¢¼

1. å¾è³‡æ–™å¤¾ `solution/assets/` **è¤‡è£½ä½ éœ€è¦çš„æª”æ¡ˆ** åˆ°è³‡æ–™å¤¾ `your-work` ä¸­ã€‚ä½ æœƒåŠ å…¥æª”æ¡ˆ `life.png`ã€‚åœ¨å‡½å¼ window.onload ä¸­åŠ å…¥ lifeImg ï¼š 

    ```javascript
    lifeImg = await loadTexture("assets/life.png");
    ```

1. åœ¨æª”æ¡ˆæ¸…å–®ä¸­åŠ å…¥ `lifeImg`ï¼š

    ```javascript
    let heroImg,
    ...
    lifeImg,
    ...
    eventEmitter = new EventEmitter();
    ```
  
2. **æ–°å¢è®Šæ•¸**ã€‚ åŠ å…¥ç¨‹å¼ç¢¼è¡¨é”ä½ çš„éŠæˆ²ç¸½åˆ†(0)å’Œå‰©é¤˜æ€§å‘½(3)ï¼Œä¸¦é¡¯ç¤ºåœ¨ç•«é¢ä¸Šã€‚

3. **æ“´å¢å‡½å¼ `updateGameObjects()`**ã€‚ æ“´å¢å‡½å¼ `updateGameObjects()` ä¾†è™•ç†æ•µè»ç¢°æ’ï¼š

    ```javascript
    enemies.forEach(enemy => {
        const heroRect = hero.rectFromGameObject();
        if (intersectRect(heroRect, enemy.rectFromGameObject())) {
          eventEmitter.emit(Messages.COLLISION_ENEMY_HERO, { enemy });
        }
      })
    ```

4. **åŠ å…¥ `life` èˆ‡ `points`**. 
   1. **åˆå§‹åŒ–è®Šæ•¸**ã€‚ åœ¨ `Hero` class çš„ `this.cooldown = 0` ä¸‹æ–¹ï¼Œè¨­å®šæ€§å‘½èˆ‡åˆ†æ•¸ï¼š

        ```javascript
        this.life = 3;
        this.points = 0;
        ```

   1. **åœ¨ç•«é¢ä¸Šé¡¯ç¤ºè®Šæ•¸å…§å®¹**ã€‚ åœ¨ç•«é¢ä¸Šç¹ªè£½é€™äº›æ•¸å€¼ï¼š

        ```javascript
        function drawLife() {
          // TODO, 35, 27
          const START_POS = canvas.width - 180;
          for(let i=0; i < hero.life; i++ ) {
            ctx.drawImage(
              lifeImg, 
              START_POS + (45 * (i+1) ), 
              canvas.height - 37);
          }
        }
        
        function drawPoints() {
          ctx.font = "30px Arial";
          ctx.fillStyle = "red";
          ctx.textAlign = "left";
          drawText("Points: " + hero.points, 10, canvas.height-20);
        }
        
        function drawText(message, x, y) {
          ctx.fillText(message, x, y);
        }

        ```

   1. **åœ¨éŠæˆ²è¿´åœˆä¸­åŠ å…¥å‘¼å«**ã€‚ è«‹ç¢ºä¿ä½ åŠ å…¥é€™äº›å‡½å¼åˆ° `updateGameObjects()` ä¸‹æ–¹çš„ window.onload å…§ï¼š

        ```javascript
        drawPoints();
        drawLife();
        ```

1. **åˆ¶å®šéŠæˆ²è¦å‰‡**ã€‚ åˆ¶å®šä¸‹åˆ—çš„éŠæˆ²è¦å‰‡ï¼š

   1. **åœ¨è‹±é›„èˆ‡æ•µäººç™¼ç”Ÿç¢°æ’æ™‚**ï¼Œæ‰£é™¤ä¸€æ¢ç”Ÿå‘½ã€‚
   
      æ“´å¢ `Hero` class ä¾†åŸ·è¡Œé€™æ®µæ¸›æ³•ï¼š

        ```javascript
        decrementLife() {
          this.life--;
          if (this.life === 0) {
            this.dead = true;
          }
        }
        ```

   2. **ç•¶é›·å°„æ“Šä¸­æ•µäººæ™‚**ï¼Œå¢åŠ éŠæˆ²ç¸½åˆ†ä¸€ç™¾åˆ†ã€‚

      æ“´å¢ Hero class ä¾†åŸ·è¡Œé€™æ®µåŠ æ³•ï¼š
    
        ```javascript
          incrementPoints() {
            this.points += 100;
          }
        ```

        åŠ å…¥é€™äº›å‡½å¼åˆ°ç¢°æ’äº‹ä»¶ç™¼é€å™¨ä¸­ï¼š

        ```javascript
        eventEmitter.on(Messages.COLLISION_ENEMY_LASER, (_, { first, second }) => {
           first.dead = true;
           second.dead = true;
           hero.incrementPoints();
        })

        eventEmitter.on(Messages.COLLISION_ENEMY_HERO, (_, { enemy }) => {
           enemy.dead = true;
           hero.decrementLife();
        });
        ```

âœ… åšé»ç ”ç©¶ï¼Œæ¢ç´¢å…¶ä»–ä½¿ç”¨åˆ° JavaScript èˆ‡ Canvas çš„éŠæˆ²ã€‚ä»–å€‘æœ‰ä»€éº¼å…±åŒç‰¹å¾µï¼Ÿ

åœ¨é€™å€‹å·¥ä½œçš„å°¾è²ï¼Œä½ æ‡‰è©²èƒ½åœ¨å³ä¸‹æ–¹çœ‹åˆ°ã€Œæ€§å‘½ã€å°èˆ¹ï¼›å·¦ä¸‹æ–¹çœ‹åˆ°éŠæˆ²ç¸½åˆ†ã€‚ç•¶ä½ ç¢°æ’åˆ°æ•µäººæ™‚æœƒæ‰£é™¤ç”Ÿå‘½ï¼›ç•¶ä½ æ“Šè½æ•µäººæ™‚æœƒå¢åŠ åˆ†æ•¸ã€‚åšå¾—å¥½ï¼ä½ çš„éŠæˆ²å°±å¿«å®Œæˆäº†ã€‚

---

## ğŸš€ æŒ‘æˆ°

ä½ çš„ç¨‹å¼å°±å¿«å®Œæˆäº†ã€‚ä½ èƒ½é æ¸¬åˆ°ä¸‹ä¸€æ­¥å—ï¼Ÿ

## èª²å¾Œæ¸¬é©—

[èª²å¾Œæ¸¬é©—](https://ashy-river-0debb7803.1.azurestaticapps.net/quiz/38?loc=zh_tw)

## è¤‡ç¿’èˆ‡è‡ªå­¸

ç ”ç©¶å…¶ä»–ç¨®å¢åŠ èˆ‡æ¸›å°‘åˆ†æ•¸èˆ‡ç”Ÿå‘½æ•¸çš„æ–¹æ³•ã€‚é€™é‚Šæœ‰ä¸€äº›æœ‰è¶£çš„éŠæˆ²å¼•æ“ï¼Œä¾‹å¦‚ï¼š[PlayFab](https://playfab.com)ã€‚ä½¿ç”¨é€™äº›å¼•æ“èƒ½å¦‚ä½•å¢é€²ä½ çš„éŠæˆ²ï¼Ÿ

## ä½œæ¥­

[å»ºç«‹è¨ˆåˆ†éŠæˆ²](assignment.zh-tw.md)
